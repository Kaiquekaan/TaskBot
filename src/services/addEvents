const { google } = require('googleapis');
const { auth } = require('../firebase');

async function adicionarEventoAoCalendario(evento) {
  const user = auth().currentUser;
  
  if (!user) {
    throw new Error('Usuário não autenticado');
  }

  const token = await user.getIdToken();
  const calendar = google.calendar({
    version: 'v3',
    auth: token,
  });

  // Substitua 'primary' pelo ID do calendário desejado (use 'primary' para o calendário padrão do usuário).
  const calendarId = 'primary';

  // O evento que você deseja adicionar, deve ser um objeto seguindo a estrutura da API do Google Calendar.
  const novoEvento = {
    summary: 'Título do Evento',
    location: 'Localização do Evento',
    description: 'Descrição do Evento',
    start: {
      dateTime: '2023-11-06T10:00:00',
      timeZone: 'America/New_York', // Substitua pelo fuso horário desejado
    },
    end: {
      dateTime: '2023-11-06T12:00:00',
      timeZone: 'America/New_York',
    },
  };

  try {
    const resultado = await calendar.events.insert({
      calendarId,
      resource: novoEvento,
    });

    console.log('Evento criado:', resultado.data);

    return resultado.data;
  } catch (error) {
    console.error('Erro ao criar o evento:', error);
    throw error;
  }
}

adicionarEventoAoCalendario()
  .then((evento) => {
    // Lida com o evento criado
  })
  .catch((error) => {
    // Lida com erros
  });